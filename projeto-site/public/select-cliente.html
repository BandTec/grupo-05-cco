<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" type="image/png" href="images/icon.png" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Humildificadores | Registrar Evento</title>
    <link rel="stylesheet" href="stylesheets/create.css">
    <link rel="stylesheet" href="stylesheets/reset.css">
    <script src="js/sorteio.js"></script>
    <script src="js/grafico.js"></script>
    <script src="js/jquery-1.11.1.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@700&display=swap" rel="stylesheet">
    <!-- <link rel="stylesheet" href="stylesheets/bootstrap.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
    <link rel="stylesheet" href="stylesheets/bootstrap.min.css"> -->
    <link rel="stylesheet" href="stylesheets/create.css">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"
        integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd"
        crossorigin="anonymous"></script>
</head>

<body>
    <div class="area"></div>
    <nav class="main-menu">
        <ul>
            <li>
                <a href="http://justinfarrow.com">
                    <i class="fa fa-home fa-2x"></i>
                    <span class="nav-text">
                        Dashboard
                    </span>
                </a>

            </li>
            <li class="has-subnav">
                <a href="#">
                    <i class="fa fa-laptop fa-2x"></i>
                    <span class="nav-text">
                        Stars Components
                    </span>
                </a>

            </li>
            <li class="has-subnav">
                <a href="#">
                    <i class="fa fa-list fa-2x"></i>
                    <span class="nav-text">
                        Forms
                    </span>
                </a>

            </li>
            <li class="has-subnav">
                <a href="#">
                    <i class="fa fa-folder-open fa-2x"></i>
                    <span class="nav-text">
                        Pages
                    </span>
                </a>

            </li>
            <li>
                <a href="#">
                    <i class="fa fa-bar-chart-o fa-2x"></i>
                    <span class="nav-text">
                        Graphs and Statistics
                    </span>
                </a>
            </li>
            <li>
                <a href="#">
                    <i class="fa fa-font fa-2x"></i>
                    <span class="nav-text">
                        Quotes
                    </span>
                </a>
            </li>
            <li>
                <a href="#">
                    <i class="fa fa-table fa-2x"></i>
                    <span class="nav-text">
                        Tables
                    </span>
                </a>
            </li>
            <li>
                <a href="#">
                    <i class="fa fa-map-marker fa-2x"></i>
                    <span class="nav-text">
                        Maps
                    </span>
                </a>
            </li>
            <li>
                <a href="#">
                    <i class="fa fa-info fa-2x"></i>
                    <span class="nav-text">
                        Documentation
                    </span>
                </a>
            </li>
        </ul>

        <ul class="logout">
            <li>
                <a href="#">
                    <i class="fa fa-power-off fa-2x"></i>
                    <span class="nav-text">
                        Logout
                    </span>
                </a>
            </li>
        </ul>
    </nav>
    <div class="header-create">
        <div class="title">
            <br>
            <h1>Clientes</h1>
        </div>
    </div>
    <div class="create">
        <div class="container">
            <table id="customers">
                <tr>
                    <th>idCliente</th>
                    <th>Nome</th>
                    <th>Rua</th>
                    <th>Cidade</th>
                    <th>Estado</th>
                    <th>DtNascimento</th>
                    <th>eMail</th>
                    
                    <th>preferenciaTemp</th>
                    <th>preferenciaUmid</th>
                </tr>
                
            </table>
        </div>
    </div>
</body>

</html>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>

<script>

    window.onload = obterDadosDaTabela
    var dados
    
    function obterDadosDaTabela() {

        fetch(`/leituras/todosClientes`, {
            cache: 'no-store'
        }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {

                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

                    dadosComponente = resposta;

                    resposta.reverse();
                    var tabela = ""
                    dados = resposta
                    for (i = 0; i < resposta.length; i++) {
                        

                        // aqui, após 'registro.' use os nomes 
                        // dos atributos que vem no JSON 
                        // que gerou na consulta ao banco de dados

                        tabela += `
                                    <tr>
                                        <td>${dados[i].idCliente}</td>
                                        <td>${dados[i].nome}</td>
                                        <td>${dados[i].rua}</td>
                                        <td>${dados[i].cidade}</td>
                                        <td>${dados[i].estado}</td>
                                        <td>${dados[i].ddn}</td>
                                        <td>${dados[i].email}</td>
                                        
                                        <td>${dados[i].preferenciaTemp}</td>
                                        <td>${dados[i].preferenciaUmid}</td>
                                    </tr>`

                        
                    }
                    console.log(JSON.stringify(dados));

                    customers.innerHTML += tabela

                    plotarGrafico(dados);

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });

    }



</script>